<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banking Financial Analysis Tool with AI Parser</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/tesseract.js@v2.1.0/dist/tesseract.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="app-header">
            <h1>Banking Financial Analysis Tool</h1>
            <p>Comprehensive financial statement analysis with AI-powered document parsing</p>
            <div class="header-actions">
                <button class="btn btn--secondary" onclick="clearAllData()">Clear All</button>
                <button class="btn btn--primary" onclick="exportResults()">Export Results</button>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="tab-navigation">
            <button class="tab-button active" data-tab="manual-input" onclick="switchTab('manual-input')">
                Manual Input
            </button>
            <button class="tab-button" data-tab="screenshot-parser" onclick="switchTab('screenshot-parser')">
                Screenshot Parser
            </button>
            <button class="tab-button" data-tab="results-dashboard" onclick="switchTab('results-dashboard')">
                Results Dashboard
            </button>
        </nav>

        <!-- Tab Content: Manual Input -->
        <div id="manual-input" class="tab-content active">
            <div class="input-sections">
                <!-- Balance Sheet Section -->
                <section class="card input-section">
                    <h2 class="section-title">Balance Sheet Data</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="total_assets">Total Assets (‚Çπ Cr)</label>
                            <input type="number" id="total_assets" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="interest_earning_assets">Interest Earning Assets (‚Çπ Cr)</label>
                            <input type="number" id="interest_earning_assets" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="cash_equivalents">Cash & Cash Equivalents (‚Çπ Cr)</label>
                            <input type="number" id="cash_equivalents" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="short_term_investments">Short-term Investments (‚Çπ Cr)</label>
                            <input type="number" id="short_term_investments" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="gross_advances">Gross Advances/Loans (‚Çπ Cr)</label>
                            <input type="number" id="gross_advances" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="gross_npas">Gross NPAs (‚Çπ Cr)</label>
                            <input type="number" id="gross_npas" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="provisions_npas">Provisions for NPAs (‚Çπ Cr)</label>
                            <input type="number" id="provisions_npas" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="total_liabilities">Total Liabilities (‚Çπ Cr)</label>
                            <input type="number" id="total_liabilities" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="deposits">Total Deposits (‚Çπ Cr)</label>
                            <input type="number" id="deposits" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="external_debt">External Debt (‚Çπ Cr)</label>
                            <input type="number" id="external_debt" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="shareholders_equity">Shareholders Equity (‚Çπ Cr)</label>
                            <input type="number" id="shareholders_equity" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="risk_weighted_assets">Risk Weighted Assets (‚Çπ Cr)</label>
                            <input type="number" id="risk_weighted_assets" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="tier1_capital">Tier 1 Capital (‚Çπ Cr)</label>
                            <input type="number" id="tier1_capital" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="tier2_capital">Tier 2 Capital (‚Çπ Cr)</label>
                            <input type="number" id="tier2_capital" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                    </div>
                </section>

                <!-- Income Statement Section -->
                <section class="card input-section">
                    <h2 class="section-title">Income Statement Data</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="interest_income">Interest Income (‚Çπ Cr)</label>
                            <input type="number" id="interest_income" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="interest_expense">Interest Expense (‚Çπ Cr)</label>
                            <input type="number" id="interest_expense" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="non_interest_income">Non-Interest Income (‚Çπ Cr)</label>
                            <input type="number" id="non_interest_income" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="operating_income">Operating Income (‚Çπ Cr)</label>
                            <input type="number" id="operating_income" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="operating_expenses">Operating Expenses (‚Çπ Cr)</label>
                            <input type="number" id="operating_expenses" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="provisions_writeoffs">Provisions & Write-offs (‚Çπ Cr)</label>
                            <input type="number" id="provisions_writeoffs" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="net_income">Net Income/PAT (‚Çπ Cr)</label>
                            <input type="number" id="net_income" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                    </div>
                </section>

                <!-- Previous Period Data -->
                <section class="card input-section">
                    <h2 class="section-title">Previous Period Data (for Growth Calculations)</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="prev_aum">Previous AUM (‚Çπ Cr)</label>
                            <input type="number" id="prev_aum" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="prev_loans">Previous Loans (‚Çπ Cr)</label>
                            <input type="number" id="prev_loans" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="prev_deposits">Previous Deposits (‚Çπ Cr)</label>
                            <input type="number" id="prev_deposits" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="prev_operating_income">Previous Operating Income (‚Çπ Cr)</label>
                            <input type="number" id="prev_operating_income" class="form-control" placeholder="0" step="0.01" oninput="calculateMetrics()">
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- Tab Content: Screenshot Parser -->
        <div id="screenshot-parser" class="tab-content">
            <div class="parser-container">
                <!-- Upload Section -->
                <section class="card upload-section">
                    <h2 class="section-title">Upload Financial Statement</h2>
                    <div class="upload-area" id="upload-area">
                        <div class="upload-content">
                            <div class="upload-icon">üìÑ</div>
                            <h3>Drag & Drop your financial statement here</h3>
                            <p>or click to browse files</p>
                            <p class="upload-info">Supports: PNG, JPG, WebP (Max: 10MB)</p>
                        </div>
                        <input type="file" id="file-input" accept="image/*" class="hidden">
                    </div>
                    
                    <!-- Processing Status -->
                    <div id="processing-status" class="processing-status hidden">
                        <div class="status-item">
                            <div class="status-icon" id="upload-status">‚è≥</div>
                            <span>Processing Image...</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                    </div>
                </section>

                <!-- Image Preview Section -->
                <section class="card preview-section hidden" id="preview-section">
                    <h2 class="section-title">Document Preview</h2>
                    <div class="image-preview-container">
                        <img id="preview-image" alt="Financial Statement Preview" class="preview-image">
                        <div class="image-controls">
                            <button class="btn btn--secondary" onclick="zoomImage(-0.1)">Zoom Out</button>
                            <button class="btn btn--secondary" onclick="zoomImage(0.1)">Zoom In</button>
                            <button class="btn btn--secondary" onclick="resetImage()">Reset</button>
                        </div>
                    </div>
                </section>

                <!-- Field Mapping Section -->
                <section class="card mapping-section hidden" id="mapping-section">
                    <h2 class="section-title">Extracted Data & Field Mapping</h2>
                    
                    <!-- Document Classification -->
                    <div class="document-info">
                        <div class="doc-type">
                            <strong>Detected Document Type:</strong>
                            <span id="document-type" class="doc-type-badge">Unknown</span>
                        </div>
                    </div>

                    <!-- Field Mapping Grid -->
                    <div class="mapping-grid">
                        <div class="extracted-data">
                            <h3>Extracted Text Data</h3>
                            <div id="extracted-text" class="extracted-text-container">
                                <!-- Extracted text will appear here -->
                            </div>
                        </div>
                        
                        <div class="field-mappings">
                            <h3>Field Mappings</h3>
                            <div id="field-mappings-container" class="field-mappings-container">
                                <!-- Field mappings will appear here -->
                            </div>
                            
                            <div class="mapping-actions">
                                <button class="btn btn--primary" onclick="applyMappings()">Apply to Form</button>
                                <button class="btn btn--secondary" onclick="clearMappings()">Clear Mappings</button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- Tab Content: Results Dashboard -->
        <div id="results-dashboard" class="tab-content">
            <div class="results-dashboard">
                <h2>Analysis Results</h2>
                
                <!-- Growth Metrics -->
                <section class="card results-section">
                    <h3 class="results-category-title">Growth Metrics</h3>
                    <div class="metrics-grid">
                        <div class="metric-card" id="aum_growth">
                            <div class="metric-name">AUM Growth (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: 15-20%</div>
                        </div>
                        <div class="metric-card" id="loan_growth">
                            <div class="metric-name">Loan Growth (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: 15-25%</div>
                        </div>
                        <div class="metric-card" id="deposit_growth">
                            <div class="metric-name">Deposit Growth (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: 15-20%</div>
                        </div>
                        <div class="metric-card" id="op_income_growth">
                            <div class="metric-name">Operating Income Growth (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: 12-18%</div>
                        </div>
                    </div>
                </section>

                <!-- Profitability Metrics -->
                <section class="card results-section">
                    <h3 class="results-category-title">Profitability Metrics</h3>
                    <div class="metrics-grid">
                        <div class="metric-card" id="nim">
                            <div class="metric-name">Net Interest Margin (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: 3.0-4.5%</div>
                        </div>
                        <div class="metric-card" id="gross_nim">
                            <div class="metric-name">Gross NIM (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: 7-10%</div>
                        </div>
                        <div class="metric-card" id="roa">
                            <div class="metric-name">ROA (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: 1.0-2.0%</div>
                        </div>
                        <div class="metric-card" id="roe">
                            <div class="metric-name">ROE (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: 12-18%</div>
                        </div>
                        <div class="metric-card" id="ppp_ratio">
                            <div class="metric-name">PPP % of AR (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: 2.5-4.0%</div>
                        </div>
                    </div>
                </section>

                <!-- Asset Quality Metrics -->
                <section class="card results-section">
                    <h3 class="results-category-title">Asset Quality Metrics</h3>
                    <div class="metrics-grid">
                        <div class="metric-card" id="gross_npa">
                            <div class="metric-name">Gross NPA (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: <3%</div>
                        </div>
                        <div class="metric-card" id="net_npa">
                            <div class="metric-name">Net NPA (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: <1%</div>
                        </div>
                        <div class="metric-card" id="credit_cost">
                            <div class="metric-name">Credit Cost (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: <1%</div>
                        </div>
                        <div class="metric-card" id="provision_coverage">
                            <div class="metric-name">Provision Coverage (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: >70%</div>
                        </div>
                    </div>
                </section>

                <!-- Efficiency Metrics -->
                <section class="card results-section">
                    <h3 class="results-category-title">Efficiency Metrics</h3>
                    <div class="metrics-grid">
                        <div class="metric-card" id="efficiency_ratio">
                            <div class="metric-name">Efficiency Ratio (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: <50%</div>
                        </div>
                        <div class="metric-card" id="cost_to_income">
                            <div class="metric-name">Cost-to-Income (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: 40-60%</div>
                        </div>
                    </div>
                </section>

                <!-- Capital Adequacy Metrics -->
                <section class="card results-section">
                    <h3 class="results-category-title">Capital Adequacy Metrics</h3>
                    <div class="metrics-grid">
                        <div class="metric-card" id="car">
                            <div class="metric-name">CAR (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: >11.5%</div>
                        </div>
                        <div class="metric-card" id="external_debt_tnw">
                            <div class="metric-name">External Debt/TNW (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: <100%</div>
                        </div>
                    </div>
                </section>

                <!-- Liquidity Metrics -->
                <section class="card results-section">
                    <h3 class="results-category-title">Liquidity Metrics</h3>
                    <div class="metrics-grid">
                        <div class="metric-card" id="loan_to_deposit">
                            <div class="metric-name">Loan-to-Deposit (%)</div>
                            <div class="metric-value">-</div>
                            <div class="metric-benchmark">Benchmark: 70-80%</div>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- Loading Modal -->
        <div id="loading-modal" class="modal hidden">
            <div class="modal-content">
                <div class="loading-spinner"></div>
                <h3>Processing Financial Statement...</h3>
                <p id="loading-text">Initializing OCR engine...</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="modal-progress-fill"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
